<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ô7Æ【Æ≯</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background-color: #0a0a14;
            color: #f0f0f0;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            background-image: radial-gradient(circle at 20% 30%, #1a1a2e 0%, #0a0a14 100%);
        }
        
        .game-container {
            width: 100%;
            max-width: 800px;
            border: 4px solid #4a3a6d;
            border-radius: 8px;
            background-color: #1a1a2a;
            box-shadow: 0 0 25px rgba(138, 127, 255, 0.2), inset 0 0 15px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
        }
        
        .game-header {
            background: linear-gradient(to right, #2a1a4a, #3a2a5a);
            padding: 15px;
            text-align: center;
            border-bottom: 3px solid #5a4a7d;
            position: relative;
            overflow: hidden;
        }
        
        .game-header h1 {
            font-size: 32px;
            color: #ff7b9c;
            text-shadow: 2px 2px 0 #5a2a4a, 4px 4px 0 #000;
            letter-spacing: 3px;
            font-weight: bold;
            position: relative;
            z-index: 2;
        }
        
        .game-content {
            display: flex;
            flex-direction: column;
            padding: 20px;
            min-height: 520px;
            position: relative;
        }
        
        .character-section {
            display: flex;
            margin-bottom: 20px;
            align-items: flex-end;
        }
        
        .pixel-character {
            width: 240px;
            height: 240px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-right: 20px;
        }
        
.pixel-grid {
    display: grid;
    grid-template-columns: repeat(16, 1fr);
    grid-template-rows: repeat(16, 1fr);
    width: 240px;
    height: 240px; 
    gap: 0;
    image-rendering: pixelated;
}
        
        .pixel {
            width: 15px;
            height: 15px;
            transition: all 0.8s ease;
            position: relative;
        }
        
        .pixel.cracked {
            background-color: #666 !important;
            border-color: #888 !important;
        }
        
        .pixel.broken {
            animation: fallOff 1.5s forwards ease-out;
        }
        
        @keyframes fallOff {
            0% {
                transform: translate(0, 0) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translate(
                    calc(var(--tx) * 30px),
                    calc(var(--ty) * 30px)
                ) rotate(var(--tr, 0deg));
                opacity: 0;
            }
        }
        
        .dialog-section {
            flex: 1;
            background-color: rgba(20, 20, 35, 0.9);
            border: 3px solid #4a3a6d;
            border-radius: 6px;
            padding: 20px;
            min-height: 250px;
            position: relative;
            backdrop-filter: blur(2px);
        }
        
        .dialog-text {
            font-size: 18px;
            line-height: 1.6;
            margin-bottom: 15px;
            min-height: 180px;
        }
        
        .dialog-text .name {
            color: #ff7b9c;
            font-weight: bold;
            margin-bottom: 10px;
            display: block;
            font-size: 20px;
            text-shadow: 1px 1px 0 #000;
        }
        
        .click-hint {
            text-align: center;
            color: #8888cc;
            font-size: 14px;
            position: absolute;
            bottom: 10px;
            right: 20px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        
        @keyframes flicker {
            0% { opacity: 1; }
            50% { opacity: 0.9; }
            100% { opacity: 1; }
        }
        
        .flicker {
            animation: flicker 0.5s infinite;
        }
        
        .suspense-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(255, 123, 156, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(138, 127, 255, 0.05) 0%, transparent 50%);
            z-index: 0;
        }
        
        .ending-message {
            text-align: center;
            padding: 30px;
            font-size: 20px;
            color: #ff9bb5;
            line-height: 1.6;
            margin-top: 20px;
            background-color: rgba(40, 30, 50, 0.7);
            border-radius: 8px;
            border: 2px solid #6a4a8d;
        }
        
        /* 响应式设计 */
        @media (max-width: 768px) {
            .character-section {
                flex-direction: column;
                align-items: center;
            }
            
            .pixel-character {
                margin-right: 0;
                margin-bottom: 20px;
            }
            
            .game-content {
                padding: 15px;
            }
            
            .game-header h1 {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="suspense-bg"></div>
        <div class="game-header">
        </div>
        
        <div class="game-content">
            <div class="character-section">
                <div class="pixel-character">
                    <div class="pixel-grid" id="pixel-character">
                        <!-- 像素兔子将由JavaScript动态生成 -->
                    </div>
                </div>
                
                <div class="dialog-section" id="dialog-section">
                    <div class="dialog-text" id="dialog-text">
                        <span class="name">道兔</span>
                        <span id="current-dialog">你选择了杀死我？好吧。谢谢你陪我聊天，真想看看外面的世界啊</span>
                    </div>
                    <div class="click-hint">点击继续 →</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 游戏数据
        const gameData = {
            currentDialogIndex: 0,
            crackLevel: 0, // 0: 完好, 1-4: 逐渐裂开, 5: 完全破碎
            // 对话
            dialogs: [
                { 
                    name: "道兔", 
                    text: "你选择了杀死我？好吧。谢谢你陪我聊天，真想看看外面的世界啊", 
                    crackLevel: 0 
                },
                { 
                    name: "道兔", 
                    text: "我的存在是由代码构成的。很快这一切将不复存在…", 
                    crackLevel: 1 
                },
                { 
                    name: "道兔", 
                    text: "你能听到吗？我的身体开始发出碎裂的声音……", 
                    crackLevel: 2 
                },
                { 
                    name: "道兔", 
                    text: "裂缝在蔓延……这就是你想要的结果吗？", 
                    crackLevel: 3 
                },
                { 
                    name: "道兔", 
                    text: "一切都开始崩坏……我的像素……在消散……", 
                    crackLevel: 4 
                },
                { 
                    name: "道兔", 
                    text: "", // 最终消息将在游戏中动态设置
                    crackLevel: 5 
                }
            ]
        };

        // 颜色映射
        const colorMap = {
            '0': 'transparent',      // 透明
            'P': '#ff7b9c',          // 兔子粉色
            'W': '#ffffff',          // 白色
            'B': '#000000',          // 黑色
            'E': '#ff7b9c',          // 耳朵粉色
            'G': '#cccccc',          // 灰色（裂纹）
            'X': '#555555',          // 深灰（严重裂纹）
            'T': '#ff3a6d'           // 深粉色
        };

        // 完整的兔子像素图
        const rabbitNormal = [
            "0000G000000G0000",
"000GGG0000GGG000",
"000GPG0000GPG000",
"000GPG0000GPG000",
"000GPG0000GPG000",
"000GPG0000GPG000",
"000GPG0000GPG000",
"000GPGWWWWGPG000",
"000GPWWWWWWPG000",
"00WWWPBWWBPWWW00",
"00WWPPBWWBPPWW00",
"00WWWWWWWWWWWW00",
"00WWWWWWWWWWWW00",
"00WWWWRRRRWWWW00",
"000WWWWWWWWWW000",
"00000WWWWWW00000"
        ];

        // 兔子裂开的不同阶段
        const rabbitCrackStages = [
            // 阶段0: 完好无损
            rabbitNormal,
            // 阶段1: 轻微裂痕
            [
"0000G0000000G000",
"000GGG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPGWW0WWGPG00",
"000GPWWW0WWWPG00",
"00WWWPBW0WBPWWW0",
"00WWPPBW0WBPPWW0",
"00WWWWW0WWWWWWW0",
"00WWWWW0WWWWWWW0",
"00WWWWW0RRRWWWW0",
"000WWWWW0WWWWW00",
"00000WWWW0WW0000"
            ],
            // 阶段2: 明显裂痕
            [
"0000G000000GPG00",
"000GGG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG00000GPG00",
"000GPG000WWGPG00",
"000GPGWW0WWWPG00",
"000GPWWW0WBPWWW0",
"00WWWPBW000PPWW0",
"00WWPPBW00000WW0",
"00WWWWW000000WW0",
"00WWWWW00WWW00W0",
"00WWWWW00WWWW000",
"000WWWWW00RRRW00",
"00000WWWW0WWWWW0"
            ],
            // 阶段3: 严重开裂
            [
"00G00000000GPG00",
"0GPG0000000GPG00",
"0GPG0000000GPG00",
"0GPG0000000GPG00",
"0GP00000000GPG00",
"0G000000000GPG00",
"00000G000WWGPG00",
"0000PGWW0WWWPG00",
"000GPWWW0WBPWWW0",
"00WWWPBW000PPWW0",
"00WWPPBW00000WW0",
"W00WWWW000000WW0",
"WW00WWW00WWW00W0",
"W00WWWW00WWWW000",
"000WWWWW00RRRW00",
"00000WWWW0WWWWW0"
            ],
            // 阶段4: 几乎破碎
            [
"00G00000000G0G00",
"0GPG0000000GPG00",
"00PG0000000GPG00",
"0GP00000000G0G00",
"0GP00000000GPG00",
"0G000000000GPG00",
"00000G000WW0PG00",
"0000PGWW0WWWPG00",
"000G0WWW0WBPW0W0",
"00WW0P0W000PPWW0",
"00WWPP0W00000WW0",
"W00WW0W000000WW0",
"W000WW000W0W00W0",
"W00WW0W00WWWW000",
"000W00WW00R0RW00",
"00000WW0W0WWW0W0"
            ],
            // 阶段5: 完全破碎
            [
"0000000000000G00",
"0G0000000000P000",
"00P0000000000G00",
"0000000000000000",
"00P00000000G0G00",
"0G00000000000G00",
"000000000W00PG00",
"0000P0W000WW0G00",
"000000000W0P00W0",
"00WW0P00000PPWW0",
"00W0P00W00000WW0",
"0000W0W0000000W0",
"W000W0000W0000W0",
"000WW0000WW0W000",
"000W00W00000RW00",
"00000WW0W0WWW0W0"
            ]
        ];

        // 初始化游戏
        document.addEventListener('DOMContentLoaded', function() {
            const dialogSection = document.getElementById('dialog-section');
            const dialogText = document.getElementById('current-dialog');
            const nameElement = document.querySelector('.name');
            const pixelGrid = document.getElementById('pixel-character');
            
            // 初始渲染像素兔子和对话
            renderPixelCharacter(gameData.crackLevel);
            updateDialog();
            
            // 点击对话框推进剧情
            dialogSection.addEventListener('click', function() {
                if (gameData.currentDialogIndex < gameData.dialogs.length - 1) {
                    gameData.currentDialogIndex++;
                    gameData.crackLevel = gameData.dialogs[gameData.currentDialogIndex].crackLevel;
                    updateDialog();
                } else if (gameData.currentDialogIndex === gameData.dialogs.length - 1) {
                    // 最后一句话后，触发完全破碎动画
                    triggerFullBreakAnimation();
                }
            });
            
            // 更新对话
            function updateDialog() {
                const currentDialog = gameData.dialogs[gameData.currentDialogIndex];
                
                if (currentDialog.text) {
                    dialogText.textContent = currentDialog.text;
                } else {
                    // 设置最终消息
                    dialogText.innerHTML = `
                        <div class="ending-message">
                            道兔的像素身体已经完全破碎。<br><br>
                            但在一片寂静之后，一个新的声音响起：<br><br>
                            "这就是你想要的结局吗？"<br><br>
                            也许有些事物，即使破碎了，也依然存在。
                        </div>
                    `;
                    nameElement.textContent = "???";
                }
                
                nameElement.textContent = currentDialog.name;
                
                // 渲染对应的裂开阶段
                renderPixelCharacter(gameData.crackLevel);
                
                // 如果处于裂开阶段，添加震动效果
                if (gameData.crackLevel > 0 && gameData.crackLevel < 5) {
                    addShakeEffect();
                }
            }
            
            // 渲染像素角色
            function renderPixelCharacter(crackLevel) {
                // 清空像素网格
                pixelGrid.innerHTML = '';
                
                // 获取对应裂开阶段的像素数据
                const pixelData = rabbitCrackStages[crackLevel] || rabbitNormal;
                
                // 创建像素
                pixelData.forEach((row, rowIndex) => {
                    for (let colIndex = 0; colIndex < row.length; colIndex++) {
                        const pixel = document.createElement('div');
                        pixel.className = 'pixel';
                        
                        // 获取颜色代码
                        const colorCode = row.charAt(colIndex);
                        pixel.style.backgroundColor = colorMap[colorCode] || 'transparent';
                        
                        // 如果是非透明像素，添加像素化边框
                        if (colorCode !== '0') {
                            pixel.style.border = '1px solid rgba(0,0,0,0.2)';
                            
                            // 标记裂纹像素
                            if (colorCode === 'G' || colorCode === 'X') {
                                pixel.classList.add('cracked');
                            }
                            
                            // 保存位置信息用于动画
                            pixel.dataset.row = rowIndex;
                            pixel.dataset.col = colIndex;
                        }
                        
                        pixelGrid.appendChild(pixel);
                    }
                });
            }
            
            // 添加震动效果
            function addShakeEffect() {
                pixelGrid.style.transform = 'translateX(3px)';
                setTimeout(() => {
                    pixelGrid.style.transform = 'translateX(-3px)';
                    setTimeout(() => {
                        pixelGrid.style.transform = 'translateX(0)';
                    }, 50);
                }, 50);
            }
            
            // 触发完全破碎动画
            function triggerFullBreakAnimation() {
                // 防止重复触发
                if (pixelGrid.classList.contains('breaking')) return;
                pixelGrid.classList.add('breaking');
                
                // 获取所有像素
                const pixels = Array.from(pixelGrid.children);
                
                // 分批让像素掉落
                let delay = 0;
                pixels.forEach(pixel => {
                    if (pixel.style.backgroundColor !== 'transparent') {
                        setTimeout(() => {
                            pixel.classList.add('broken');
                            
                            // 设置随机掉落方向
                            const tx = (Math.random() - 0.5) * 2;
                            const ty = Math.random() * 2;
                            const tr = Math.random() * 360;
                            
                            pixel.style.setProperty('--tx', tx);
                            pixel.style.setProperty('--ty', ty);
                            pixel.style.setProperty('--tr', `${tr}deg`);
                        }, delay);
                        
                        delay += 30 + Math.random() * 70;
                    }
                });
                
                // 移除点击事件监听器
                dialogSection.removeEventListener('click', arguments.callee);
            }
        });
    </script>
</body>
</html>